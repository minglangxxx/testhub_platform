# TestHub 评审功能问题排查指南

## 常见500错误解决方案

### 1. 序列化器循环导入问题

**问题症状**: 访问 `/api/reviews/` 或 `/api/review-templates/` 返回500错误

**解决方案**: 已修复序列化器循环导入问题，使用简化的序列化器避免相互引用

### 2. 数据库迁移问题

**排查步骤**:
```bash
# 检查迁移状态
python3 manage.py showmigrations

# 如果reviews应用没有迁移，执行迁移
python3 manage.py makemigrations reviews
python3 manage.py migrate
```

### 3. 应用配置问题

**检查清单**:
- [ ] `apps.reviews` 已添加到 `INSTALLED_APPS`
- [ ] URL配置已正确添加
- [ ] 模型字段定义正确

### 4. 权限问题

**检查**: 确保用户已登录且有相应权限

### 5. 前端API调用问题

**常见问题**:
- API路径错误
- 数据格式不匹配
- 认证token缺失

## 调试步骤

### 步骤1: 运行模型检查
```bash
python3 debug_review_api.py
```

### 步骤2: 检查Django日志
查看 `logs/django.log` 中的错误信息

### 步骤3: 测试API接口
```bash
# 使用curl测试基本接口
curl -H "Authorization: Token YOUR_TOKEN" http://localhost:8000/api/reviews/
```

### 步骤4: 浏览器开发者工具
检查Network标签中的具体错误响应

## 快速修复命令

```bash
# 重新创建迁移文件
rm -rf apps/reviews/migrations/0*.py
python3 manage.py makemigrations reviews
python3 manage.py migrate

# 创建测试数据
python3 create_review_test_data.py

# 重启服务
python3 manage.py runserver
```

## 联系支持

如果问题仍然存在，请提供：
1. 具体错误消息
2. Django日志内容
3. 浏览器控制台错误
4. 操作步骤

## 验证清单

功能正常时应该满足：
- [ ] `/api/reviews/` 返回评审列表（可能为空）
- [ ] `/api/review-templates/` 返回模板列表（可能为空）
- [ ] 前端页面可以正常加载
- [ ] 可以创建新的评审和模板
- [ ] 数据库中相关表存在并可查询