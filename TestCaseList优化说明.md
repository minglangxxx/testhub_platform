# TestCaseList.vue 优化说明

## 优化内容

### 1. 新增左侧项目/版本树形导航

- **位置**: 页面左侧，宽度 280px
- **功能**: 
  - 第一级：项目列表（显示文件夹图标）
  - 第二级：每个项目下的关联版本列表（显示文档图标）
  - 基线版本会显示黄色"基线"标签
  - 点击项目节点：按该项目过滤用例
  - 点击版本节点：按该项目+版本过滤用例
  - 清除筛选按钮：清除当前选择，显示所有用例

### 2. 右侧用例列表过滤

- **功能**: 
  - 根据左侧树选中的项目或版本进行实时过滤
  - 显示当前筛选状态的提示信息
  - 保留原有的搜索、优先级、状态筛选功能
  - 导出 Excel 时也会应用左侧树的过滤条件

### 3. 布局调整

- 使用 `el-container` + `el-aside` + `el-main` 实现左右布局
- 左侧树形区域：
  - 固定宽度 280px
  - 浅灰背景色区分
  - 独立的头部和滚动区域
- 右侧内容区域：
  - 自适应宽度
  - 保留所有原有功能
  - 响应式高度适配

## 技术实现

### API 调用

1. **获取项目列表**: `GET /api/projects/`
2. **获取项目版本**: `GET /api/versions/projects/{project_id}/versions/`
3. **获取用例列表（带过滤）**: `GET /api/testcases/?project={project_id}&version={version_id}`

### 数据结构

```javascript
// 树形数据结构
treeData: [
  {
    id: 'project-1',
    label: '项目名称',
    type: 'project',
    projectId: 1,
    children: [
      {
        id: 'version-1',
        label: '版本名称',
        type: 'version',
        projectId: 1,
        projectName: '项目名称',
        versionId: 1,
        is_baseline: false
      }
    ]
  }
]
```

### 核心函数

1. `fetchProjectsAndVersions()` - 获取项目和版本，构建树形数据
2. `handleTreeNodeClick(data)` - 处理树节点点击，更新过滤条件
3. `clearSelection()` - 清除当前选择，重置过滤
4. `getFilterInfoText()` - 获取当前筛选状态的描述文本

## 使用说明

### 基本操作

1. **按项目筛选用例**:
   - 点击左侧项目名称
   - 右侧显示该项目所有版本的用例
   - 顶部显示蓝色提示条："当前筛选：项目名 （所有版本）"

2. **按版本筛选用例**:
   - 展开项目节点
   - 点击具体版本
   - 右侧仅显示该项目该版本的用例
   - 顶部显示蓝色提示条："当前筛选：项目名 / 版本名"

3. **清除筛选**:
   - 点击左侧顶部"清除筛选"按钮
   - 或使用右侧原有的搜索和筛选条件

4. **组合筛选**:
   - 左侧树选择项目/版本
   - 右侧同时可以使用搜索、优先级、状态筛选
   - 所有条件会同时生效

### 导出功能

- 点击"导出Excel"按钮
- 导出的数据会包含当前所有筛选条件（包括左侧树选择）
- 导出文件名：`测试用例_YYYY-MM-DD.xlsx`

## 样式特点

1. **左侧树区域**:
   - 浅灰背景（#fafafa）与主内容区分
   - 白色卡片式头部
   - 树节点悬停高亮
   - 图标颜色区分（项目蓝色，版本灰色）

2. **右侧内容区**:
   - 保持原有样式
   - 筛选提示使用 Element Plus Alert 组件
   - 响应式布局，自动适配剩余空间

3. **响应式设计**:
   - 容器高度：`calc(100vh - 200px)`
   - 树和表格区域独立滚动
   - 适配不同屏幕尺寸

## 注意事项

1. 左侧树加载时会依次获取所有项目及其版本，可能需要一些时间
2. 如果项目较多，建议后续优化为懒加载模式
3. 树节点点击会自动重置分页到第一页
4. 清除筛选时会重置树的当前选中状态
